# Enable Bzlmod (MODULE.bazel system)
common --enable_bzlmod
common --lockfile_mode=update

# Redirect Bazel output and symlinks to a temporary location
startup --output_base=/tmp/bazel-output
build --symlink_prefix=/tmp/bazel-output/symlinks/

# Use clang as the default C++ compiler
build --repo_env=CC=clang
build --repo_env=CXX=clang++

# C++23 and compiler configuration
build --cxxopt=-std=c++23
build --host_cxxopt=-std=c++23
build --cxxopt=-Wall
build --cxxopt=-Wextra
build --cxxopt=-Wpedantic

# Enable parallel builds
build --jobs=32  # Use all available cores
build --local_resources=cpu=HOST_CPUS*.9  # Use 90% of available CPU resources

# Modern C++ features
build --cxxopt=-fmodules  # Enable C++20 modules
# build --cxxopt=-fcoroutines # Enable coroutines (uncomment if needed)

# Optimization flags
build --copt=-O2
build --copt=-DNDEBUG

# Debug configuration
build:debug --copt=-g
build:debug --copt=-O0
build:debug --strip=never

# Suppress specific warnings
build --cxxopt=-Wno-modules-ambiguous-internal-linkage
build --cxxopt=-Wno-deprecated-declarations

